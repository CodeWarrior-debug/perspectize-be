---
phase: 01-foundation
plan: 04
type: execute
wave: 3
depends_on: ["01-02", "01-03"]
files_modified:
  - perspectize-fe/package.json
  - perspectize-fe/src/lib/components/Header.svelte
  - perspectize-fe/src/routes/+page.svelte
  - perspectize-fe/src/lib/components/AGGridTest.svelte
  - perspectize-fe/src/app.css
  - perspectize-fe/AG_GRID_VALIDATION.md
autonomous: false

must_haves:
  truths:
    - "User can open Add Video modal from Activity page header (button shows placeholder toast)"
    - "AG Grid renders a test table with data"
    - "AG Grid sorting works (click column header)"
    - "AG Grid filtering works (filter icon)"
    - "AG Grid pagination works (page controls)"
    - "AG Grid column resize works (drag column border)"
  artifacts:
    - path: "perspectize-fe/src/lib/components/Header.svelte"
      provides: "Header with Add Video button"
      contains: "Add Video"
    - path: "perspectize-fe/src/lib/components/AGGridTest.svelte"
      provides: "AG Grid validation component"
      contains: "AgGridSvelte"
    - path: "perspectize-fe/AG_GRID_VALIDATION.md"
      provides: "AG Grid feature validation report"
      min_lines: 20
  key_links:
    - from: "perspectize-fe/src/lib/components/Header.svelte"
      to: "svelte-sonner"
      via: "toast import for placeholder"
      pattern: "toast"
    - from: "perspectize-fe/src/lib/components/AGGridTest.svelte"
      to: "ag-grid-svelte5"
      via: "import AgGridSvelte"
      pattern: "AgGridSvelte"
---

<objective>
Add "Add Video" button to header (placeholder for modal in Phase 3), and validate AG Grid Svelte 5 wrapper functionality with a comprehensive feature test.

Purpose: Provide navigation element for adding videos (modal implementation deferred to Phase 3), and derisk the AG Grid community wrapper by validating all required features (sorting, filtering, pagination, column resize, row selection) before committing to it for Phase 2.

Output: Header with Add Video button (shows placeholder toast), AG Grid validation component, and AG Grid validation report documenting which features work/fail.
</objective>

<execution_context>
@/Users/jamesjordan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jamesjordan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add "Add Video" button to Header</name>
  <files>
    perspectize-fe/src/lib/components/Header.svelte
  </files>
  <action>
    Update Header.svelte to include an "Add Video" button:

    ```svelte
    <script lang="ts">
      import { toast } from 'svelte-sonner';
      import { Button } from '$lib/components/ui/button';

      function handleAddVideo() {
        // Placeholder - modal will be implemented in Phase 3
        toast.info('Add Video modal coming in Phase 3');
      }
    </script>

    <header class="h-16 border-b border-border bg-background sticky top-0 z-50">
      <div class="h-full px-4 md:px-6 lg:px-8 max-w-screen-xl mx-auto flex items-center justify-between">
        <a href="/" class="font-bold text-xl text-foreground hover:text-primary transition-colors">
          Perspectize
        </a>
        <div class="flex items-center gap-4">
          <Button onclick={handleAddVideo}>
            Add Video
          </Button>
        </div>
      </div>
    </header>
    ```

    Key features:
    - Add Video button in header (right side)
    - Clicking shows toast: "Add Video modal coming in Phase 3"
    - Uses shadcn Button with default (navy) variant
    - Header is sticky with proper z-index
    - Logo links to home

    Note: Per user clarification, Add Video will be a modal dialog, NOT a separate page. The modal implementation is deferred to Phase 3. For now, the button shows a placeholder toast.
  </action>
  <verify>
    ```bash
    cd perspectize-fe && npm run dev
    ```
    Open http://localhost:5173:
    - "Add Video" button visible in header
    - Click button - toast appears saying "Add Video modal coming in Phase 3"
    - Toast appears in top-right and auto-dismisses
  </verify>
  <done>
    - Header.svelte has Add Video button
    - Button click shows placeholder toast
    - Header is sticky with z-50
    - Logo links to home page
    - No separate /add-video route (modal will be used in Phase 3)
  </done>
</task>

<task type="auto">
  <name>Task 2: Install AG Grid and create validation test component</name>
  <files>
    perspectize-fe/package.json
    perspectize-fe/src/lib/components/AGGridTest.svelte
    perspectize-fe/src/app.css
    perspectize-fe/src/routes/+page.svelte
  </files>
  <action>
    1. Install AG Grid packages:
       ```bash
       cd perspectize-fe
       npm install ag-grid-svelte5 ag-grid-community
       ```

    2. Add AG Grid styles to app.css (after other imports):
       ```css
       /* AG Grid base styles */
       @import 'ag-grid-community/styles/ag-grid.css';
       @import 'ag-grid-community/styles/ag-theme-quartz.css';

       /* Custom AG Grid theme to match shadcn */
       .ag-theme-quartz {
         --ag-foreground-color: var(--foreground);
         --ag-background-color: var(--background);
         --ag-header-background-color: var(--secondary);
         --ag-odd-row-background-color: oklch(0.98 0 0);
         --ag-border-color: var(--border);
         --ag-font-family: 'Inter', sans-serif;
         --ag-font-size: 14px;
         --ag-row-hover-color: var(--accent);
         --ag-selected-row-background-color: oklch(0.95 0.01 250);
       }
       ```

    3. Create AGGridTest.svelte in src/lib/components/:
       ```svelte
       <script lang="ts">
         import AgGridSvelte from 'ag-grid-svelte5';

         // Test data simulating video content
         let rowData = $state([
           { id: 1, title: 'Introduction to Svelte 5', duration: '15:42', rating: 92, published: '2026-01-15' },
           { id: 2, title: 'Building with SvelteKit', duration: '23:18', rating: 87, published: '2026-01-20' },
           { id: 3, title: 'Tailwind CSS Deep Dive', duration: '31:05', rating: 95, published: '2026-01-25' },
           { id: 4, title: 'GraphQL Fundamentals', duration: '18:33', rating: 78, published: '2026-02-01' },
           { id: 5, title: 'TypeScript Best Practices', duration: '27:41', rating: 91, published: '2026-02-03' },
           { id: 6, title: 'State Management Patterns', duration: '22:15', rating: 84, published: '2026-02-05' },
           { id: 7, title: 'Testing Svelte Components', duration: '19:28', rating: 89, published: '2026-02-07' },
           { id: 8, title: 'Performance Optimization', duration: '25:52', rating: 93, published: '2026-02-10' },
           { id: 9, title: 'Deployment Strategies', duration: '16:44', rating: 81, published: '2026-02-12' },
           { id: 10, title: 'Accessibility in Web Apps', duration: '20:36', rating: 96, published: '2026-02-15' },
           { id: 11, title: 'Advanced Svelte Patterns', duration: '28:19', rating: 90, published: '2026-02-18' },
           { id: 12, title: 'API Design Principles', duration: '24:07', rating: 86, published: '2026-02-20' },
         ]);

         let gridOptions = $state({
           columnDefs: [
             { field: 'id', headerName: 'ID', width: 80, sortable: true },
             { field: 'title', headerName: 'Title', flex: 2, filter: 'agTextColumnFilter', sortable: true },
             { field: 'duration', headerName: 'Duration', width: 120, sortable: true },
             { field: 'rating', headerName: 'Rating', width: 100, filter: 'agNumberColumnFilter', sortable: true },
             { field: 'published', headerName: 'Published', width: 130, filter: 'agDateColumnFilter', sortable: true },
           ],
           rowData,
           pagination: true,
           paginationPageSize: 5,
           paginationPageSizeSelector: [5, 10, 25],
           rowSelection: 'multiple',
           defaultColDef: {
             resizable: true,
           },
           getRowId: (params: { data: { id: number } }) => String(params.data.id),
         });

         // Track validation results
         let validationResults = $state<Record<string, boolean | null>>({
           sorting: null,
           filtering: null,
           pagination: null,
           columnResize: null,
           rowSelection: null,
           reactivity: null,
         });

         function addRow() {
           const newId = rowData.length + 1;
           rowData = [...rowData, {
             id: newId,
             title: `New Video ${newId}`,
             duration: '10:00',
             rating: 80,
             published: new Date().toISOString().split('T')[0],
           }];
           gridOptions.rowData = rowData;
         }
       </script>

       <div class="space-y-4">
         <h2 class="text-xl font-semibold">AG Grid Svelte 5 Validation</h2>

         <div class="p-4 bg-muted rounded-lg">
           <h3 class="font-medium mb-2">Validation Checklist:</h3>
           <ul class="space-y-1 text-sm">
             <li>[ ] <strong>Sorting:</strong> Click column headers to sort asc/desc</li>
             <li>[ ] <strong>Filtering:</strong> Click filter icon, enter filter values</li>
             <li>[ ] <strong>Pagination:</strong> Use page controls at bottom</li>
             <li>[ ] <strong>Column Resize:</strong> Drag column borders to resize</li>
             <li>[ ] <strong>Row Selection:</strong> Click rows to select (checkboxes)</li>
             <li>[ ] <strong>Reactivity:</strong> Click "Add Row" button, new row appears</li>
           </ul>
         </div>

         <button
           class="px-4 py-2 bg-secondary text-secondary-foreground rounded hover:bg-secondary/80"
           onclick={addRow}
         >
           Add Row (Test Reactivity)
         </button>

         <div class="ag-theme-quartz" style="height: 400px; width: 100%;">
           <AgGridSvelte {gridOptions} />
         </div>
       </div>
       ```

    4. Update +page.svelte to include AG Grid test:
       ```svelte
       <script lang="ts">
         import { toast } from 'svelte-sonner';
         import PageWrapper from '$lib/components/PageWrapper.svelte';
         import { Button } from '$lib/components/ui/button';
         import AGGridTest from '$lib/components/AGGridTest.svelte';
       </script>

       <PageWrapper>
         <h1 class="text-3xl font-bold mb-4">Activity</h1>
         <p class="text-muted-foreground mb-8">
           Recently updated content will appear here. (Phase 2)
         </p>

         <!-- AG Grid Validation Section -->
         <section class="mb-12">
           <AGGridTest />
         </section>

         <!-- Toast and Theme Tests -->
         <section class="border-t border-border pt-8">
           <h2 class="text-xl font-semibold mb-4">Theme & Toast Tests</h2>

           <div class="space-x-4 mb-4">
             <Button>Primary (Navy)</Button>
             <Button variant="secondary">Secondary</Button>
             <Button variant="outline">Outline</Button>
           </div>

           <div class="space-x-4">
             <Button variant="outline" size="sm" onclick={() => toast.success('Success!')}>
               Success Toast
             </Button>
             <Button variant="outline" size="sm" onclick={() => toast.error('Error!')}>
               Error Toast
             </Button>
           </div>
         </section>
       </PageWrapper>
       ```
  </action>
  <verify>
    ```bash
    cd perspectize-fe && npm run dev
    ```
    Open http://localhost:5173:
    - AG Grid table renders with 12 rows of test data
    - Table has navy-compatible styling (shadcn theme variables)
    - Grid fills available width
  </verify>
  <done>
    - ag-grid-svelte5 and ag-grid-community installed
    - AG Grid CSS imported and customized in app.css
    - AGGridTest.svelte created with test data
    - Grid renders on Activity page
    - Custom theme variables match shadcn styling
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Validate AG Grid features and document results</name>
  <what-built>
    AG Grid Svelte 5 integration with test data table on the Activity page. The grid has:
    - 12 rows of mock video data
    - Sortable columns (ID, Title, Duration, Rating, Published)
    - Text, number, and date filters
    - Pagination (5 items per page, selectable 5/10/25)
    - Multi-row selection
    - Resizable columns
    - "Add Row" button for reactivity testing
  </what-built>
  <how-to-verify>
    Open http://localhost:5173 and test each feature:

    1. **SORTING** - Click the "Title" column header
       - Expected: Rows sort alphabetically A-Z
       - Click again: Rows sort Z-A
       - Click a third time: Returns to original order
       - Test with "Rating" (numeric sort) and "Published" (date sort)

    2. **FILTERING** - Click the hamburger menu icon on "Title" column
       - Expected: Filter popup appears
       - Type "Svelte" in the filter input
       - Expected: Only rows with "Svelte" in title shown (3 rows)
       - Clear filter, try number filter on "Rating" (e.g., > 90)

    3. **PAGINATION** - Look at bottom of grid
       - Expected: Page controls visible (1-5 of 12)
       - Click next page arrow
       - Expected: Shows rows 6-10
       - Change page size to 10
       - Expected: Shows 10 rows per page

    4. **COLUMN RESIZE** - Hover between column headers (e.g., Title | Duration)
       - Expected: Cursor changes to resize cursor
       - Drag to resize
       - Expected: Column width changes

    5. **ROW SELECTION** - Click on a row
       - Expected: Row highlights/selects
       - Click another row while holding Ctrl/Cmd
       - Expected: Multiple rows selected

    6. **REACTIVITY** - Click "Add Row (Test Reactivity)" button
       - Expected: New row appears at end of data
       - Pagination should update (now 13 total rows)

    Report results for each feature: PASS / FAIL / PARTIAL (describe issues)
  </how-to-verify>
  <resume-signal>
    Provide validation results for each feature:
    - Sorting: PASS/FAIL
    - Filtering: PASS/FAIL
    - Pagination: PASS/FAIL
    - Column Resize: PASS/FAIL
    - Row Selection: PASS/FAIL
    - Reactivity: PASS/FAIL

    Include any issues observed. Type "all features pass" if everything works, or describe failures.
  </resume-signal>
</task>

<task type="auto">
  <name>Task 4: Document AG Grid validation results</name>
  <files>
    perspectize-fe/AG_GRID_VALIDATION.md
  </files>
  <action>
    Create AG_GRID_VALIDATION.md documenting the validation results:

    ```markdown
    # AG Grid Svelte 5 Wrapper Validation

    **Validated:** [DATE]
    **Package:** ag-grid-svelte5 (version from package.json)
    **Wrapper repo:** https://github.com/JohnMaher1/ag-grid-svelte5

    ## Summary

    [SUMMARY BASED ON CHECKPOINT RESULTS]

    ## Feature Validation Results

    | Feature | Status | Notes |
    |---------|--------|-------|
    | Sorting | [PASS/FAIL] | [Notes from validation] |
    | Filtering | [PASS/FAIL] | [Notes from validation] |
    | Pagination | [PASS/FAIL] | [Notes from validation] |
    | Column Resize | [PASS/FAIL] | [Notes from validation] |
    | Row Selection | [PASS/FAIL] | [Notes from validation] |
    | Reactivity | [PASS/FAIL] | [Notes from validation] |

    ## Styling Integration

    [Notes on how well AG Grid styling matches shadcn theme]

    ## Recommendation

    [Based on results: Proceed with AG Grid / Fallback to TanStack Table / Other recommendation]

    ### Fallback Decision Criteria

    If 3+ critical features fail or have significant issues, recommend fallback to TanStack Table for Phase 2:
    - TanStack Table is headless (full styling control with shadcn)
    - Better Svelte 5 support (official adapter)
    - Trade-off: More manual work for features AG Grid provides built-in

    ## Known Issues

    [Any issues discovered during validation]

    ## Next Steps

    [What happens in Phase 2 based on this validation]
    ```

    Fill in based on the checkpoint results provided by the user.
  </action>
  <verify>
    ```bash
    cat perspectize-fe/AG_GRID_VALIDATION.md
    ```
    File exists with validation results filled in.
  </verify>
  <done>
    - AG_GRID_VALIDATION.md created
    - All feature validation results documented
    - Recommendation for Phase 2 included (with fallback criteria)
    - Any issues noted
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Add Video button works**: Button in header, shows placeholder toast when clicked
2. **AG Grid renders**: Test table visible on Activity page
3. **Features validated**: All 6 AG Grid features tested and documented
4. **Validation documented**: AG_GRID_VALIDATION.md contains results
5. **Decision recorded**: Recommendation for Phase 2 (proceed vs fallback)
</verification>

<success_criteria>
- Header has Add Video button (shows placeholder toast, modal in Phase 3)
- No separate /add-video route created (modal approach per user clarification)
- AG Grid packages installed and configured
- AGGridTest.svelte renders on Activity page
- AG Grid themed to match shadcn (navy primary, Inter font)
- All 6 features validated (sorting, filtering, pagination, resize, selection, reactivity)
- AG_GRID_VALIDATION.md documents results and recommendation
- Fallback decision criteria documented (if 3+ features fail, use TanStack Table)
- Clear path forward for Phase 2 data table
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-04-SUMMARY.md`
</output>
