---
phase: 03.1-design-token-system
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/app.css
  - frontend/static/fonts/Charter-Regular.woff2
  - frontend/static/fonts/Charter-Italic.woff2
  - frontend/static/fonts/Charter-Bold.woff2
autonomous: false

must_haves:
  truths:
    - "All 22 Theme/Light color tokens from DESIGN_SPEC.md are defined in app.css @theme block as hex values"
    - "All 4 rating color tokens are defined (rating-positive, rating-neutral, rating-negative, rating-undecided)"
    - "Brand token logo-purple is defined"
    - "Charter font is loaded via @font-face and available via font-serif utility class"
    - "Geist + Charter dual-font system is configured (Geist as default, Charter as serif)"
    - "Existing components render correctly — Dialog has solid white bg, buttons have navy bg"
  artifacts:
    - path: "frontend/src/app.css"
      provides: "Complete design token system and Charter @font-face declarations"
      contains: "--color-background"
    - path: "frontend/static/fonts/Charter-Regular.woff2"
      provides: "Charter Regular 400 font file"
    - path: "frontend/static/fonts/Charter-Italic.woff2"
      provides: "Charter Italic 400 font file"
    - path: "frontend/static/fonts/Charter-Bold.woff2"
      provides: "Charter Bold 700 font file"
  key_links:
    - from: "frontend/src/app.css"
      to: "shadcn button/dialog components"
      via: "Tailwind v4 --color-* tokens consumed by utility classes"
      pattern: "--color-(background|foreground|primary|destructive|border|ring|muted|accent|secondary|card|popover|input)"
    - from: "frontend/src/app.css"
      to: "frontend/static/fonts/"
      via: "@font-face src urls"
      pattern: "url\\('/fonts/Charter"
---

<objective>
Define the complete design token system (27 color tokens + dual-font typography) in app.css so all shadcn components render correctly with proper backgrounds, text colors, borders, and focus states.

Purpose: The critical issue is that `bg-background` resolves to transparent because `--color-background` is never defined. This plan defines ALL required tokens, fixing the transparent dialog bug and establishing the complete color foundation. It also adds Charter as the serif font for body/content text.

Output: Updated `app.css` with complete `@theme` block, Charter font files in `static/fonts/`, and `@font-face` declarations.
</objective>

<execution_context>
@/Users/jamesjordan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jamesjordan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03.1-dialog-ux-polish/03.1-CONTEXT.md
@frontend/docs/DESIGN_SPEC.md
@frontend/src/app.css
@frontend/src/lib/components/shadcn/button/button.svelte
@frontend/src/lib/components/shadcn/dialog/dialog-content.svelte
</context>

<tasks>

<task type="auto">
  <name>Task 1: Download and install Charter font files</name>
  <files>
    frontend/static/fonts/Charter-Regular.woff2
    frontend/static/fonts/Charter-Italic.woff2
    frontend/static/fonts/Charter-Bold.woff2
  </files>
  <action>
Download Charter font files in woff2 format. Charter is a free font by Matthew Carter (Bitstream). Source the woff2 files from a reliable CDN or font distribution (e.g., practicaltypography.com/charter.html, or use fontsource/Google Fonts if available).

Place exactly 3 files in `frontend/static/fonts/`:
- `Charter-Regular.woff2` (weight 400)
- `Charter-Italic.woff2` (weight 400, italic)
- `Charter-Bold.woff2` (weight 700)

If woff2 files are not directly available, download ttf/otf and convert using a tool like `woff2_compress` or use an online converter. The key requirement is that the files exist in woff2 format in the static/fonts/ directory.

If Charter woff2 files cannot be obtained via CLI (the font may require manual download from practicaltypography.com), create a checkpoint for the user to download them. However, first try:
1. Check if fontsource has Charter: `npm info @fontsource/charter` or similar
2. Check if the font is available via a direct URL download
3. As a last resort, use `curl` to download from a known CDN

The font files must be placed alongside the existing `Geist-Variable.woff2`.
  </action>
  <verify>
Run `ls -la frontend/static/fonts/` and confirm all 4 font files exist:
- Geist-Variable.woff2 (existing)
- Charter-Regular.woff2
- Charter-Italic.woff2
- Charter-Bold.woff2

Each Charter file should be non-empty (at least a few KB).
Verify woff2 format: `file frontend/static/fonts/Charter-*.woff2` should show "Web Open Font Format" or similar binary font indicator (not HTML/text).
  </verify>
  <done>Three Charter woff2 font files exist in frontend/static/fonts/ and are non-empty.</done>
</task>

<task type="auto">
  <name>Task 2: Define all design tokens and Charter @font-face in app.css</name>
  <files>frontend/src/app.css</files>
  <action>
Replace the existing `@theme` block and add Charter `@font-face` declarations in `frontend/src/app.css`. Keep the existing `@import 'tailwindcss'`, Geist `@font-face`, and AG Grid pagination CSS unchanged.

**Add Charter @font-face declarations** (after the existing Geist @font-face):
```css
@font-face {
  font-family: 'Charter';
  src: url('/fonts/Charter-Regular.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Charter';
  src: url('/fonts/Charter-Italic.woff2') format('woff2');
  font-weight: 400;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Charter';
  src: url('/fonts/Charter-Bold.woff2') format('woff2');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}
```

**Replace the `@theme` block** with ALL tokens using hex values (not oklch). Group tokens logically:

```css
@theme {
  /* Typography */
  --default-font-family: 'Geist', system-ui, -apple-system, sans-serif;
  --font-family-serif: 'Charter', 'Georgia', 'Times New Roman', serif;

  /* Theme/Light — Base */
  --color-background: #ffffff;
  --color-foreground: #171717;

  /* Theme/Light — Card */
  --color-card: #ffffff;
  --color-card-foreground: #171717;

  /* Theme/Light — Popover */
  --color-popover: #ffffff;
  --color-popover-foreground: #171717;

  /* Theme/Light — Primary */
  --color-primary: #1a365d;
  --color-primary-hover: #2d3748;
  --color-primary-foreground: #ffffff;

  /* Theme/Light — Secondary */
  --color-secondary: #f5f5f5;
  --color-secondary-hover: rgba(245,245,245,0.8);
  --color-secondary-foreground: #525252;

  /* Theme/Light — Muted */
  --color-muted: #f5f5f5;
  --color-muted-foreground: #525252;

  /* Theme/Light — Accent */
  --color-accent: #f7fafc;
  --color-accent-foreground: #2d3748;

  /* Theme/Light — Destructive */
  --color-destructive: #dc2626;
  --color-destructive-hover: #b91c1c;
  --color-destructive-foreground: #ffffff;

  /* Theme/Light — Borders & Input */
  --color-border: #d4d4d4;
  --color-input: #d4d4d4;

  /* Theme/Light — Focus Ring */
  --color-ring: #1a365d;

  /* Rating Colors */
  --color-rating-positive: #16a34a;
  --color-rating-neutral: #ca8a04;
  --color-rating-negative: #dc2626;
  --color-rating-undecided: #64748b;

  /* Brand */
  --color-logo-purple: #8b5cf6;
}
```

**Important implementation notes:**
- Replace the existing oklch values for `--color-primary` and `--color-primary-foreground` with hex (CONTEXT decision: hex, not oklch)
- DESIGN_SPEC.md is the source of truth for all hex values (not Radix 3.0 Figma)
- `secondary-hover` uses `rgba()` — this is intentional per DESIGN_SPEC.md
- Disabled opacity: CONTEXT allows either `--opacity-disabled: 0.5` or utility class. We use the utility class approach (`disabled:opacity-50` already in shadcn button) because disabled is not a color token and doesn't fit the `--color-*` namespace. No `@theme` entry needed.
- Keep the AG Grid pagination CSS rules exactly as they are (after the @theme block)
- The `--font-family-serif` enables Tailwind's `font-serif` utility to use Charter
  </action>
  <verify>
1. Run `pnpm run build` from `frontend/` — must succeed with no errors
2. Run `pnpm run check` from `frontend/` — must succeed (type-check)
3. Verify the @theme block contains exactly 27 `--color-*` entries: count with `grep -c '\-\-color-' frontend/src/app.css` (should be 27)
4. Verify `--font-family-serif` is defined: `grep 'font-family-serif' frontend/src/app.css`
5. Verify NO oklch values remain: `grep -c 'oklch' frontend/src/app.css` (should be 0)
  </verify>
  <done>
app.css contains all 27 color tokens as hex values, Charter @font-face declarations for 3 weights, and --font-family-serif for Tailwind's font-serif utility. Zero oklch values remain. Build and type-check pass.
  </done>
</task>

</tasks>

<verification>
1. `pnpm run build` succeeds from frontend/ — no Tailwind or CSS compilation errors
2. `pnpm run check` succeeds — no TypeScript errors
3. `pnpm run test:run` succeeds — no test regressions (tests don't depend on CSS values, but confirm no breakage)
4. `grep -c '\-\-color-' frontend/src/app.css` returns 27 (exact token count)
5. `grep -c 'oklch' frontend/src/app.css` returns 0 (all hex)
6. `ls frontend/static/fonts/Charter-*.woff2 | wc -l` returns 3
7. `grep 'font-family-serif' frontend/src/app.css` matches (serif font defined)
</verification>

<success_criteria>
- All 22 Theme/Light tokens defined as hex in @theme block
- All 4 rating tokens defined as hex
- Brand token (logo-purple) defined as hex
- Charter Regular/Italic/Bold woff2 files in static/fonts/
- Charter @font-face declarations with font-display: swap
- --font-family-serif defined for Tailwind font-serif utility
- Zero oklch values in app.css
- Build, type-check, and tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/03.1-dialog-ux-polish/03.1-01-SUMMARY.md`
</output>
