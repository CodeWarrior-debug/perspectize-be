---
phase: 03.3-repository-rename-folder-restructure
plan: 02
type: execute
wave: 2
depends_on: ["03.3-01"]
files_modified:
  - .github/workflows/ci.yml
  - .github/workflows/frontend-test.yml
  - CLAUDE.md
  - backend/CLAUDE.md
  - frontend/CLAUDE.md
  - docs/*.md
  - .planning/**/*.md
autonomous: true

must_haves:
  truths:
    - "backend/ folder no longer exists; backend/ folder contains all Go code"
    - "frontend/ folder no longer exists; frontend/ folder contains all frontend code"
    - "CI workflow working-directory and cache paths reference backend/ and frontend/"
    - "Zero references to backend/ or frontend/ remain in source-controlled files"
    - "Go tests pass from backend/ directory"
    - "Frontend build succeeds from frontend/ directory"
  artifacts:
    - path: "backend/go.mod"
      provides: "Go module in renamed directory"
      contains: "github.com/CodeWarrior-debug/perspectize/backend"
    - path: "frontend/package.json"
      provides: "Frontend package in renamed directory"
      contains: "fe"
    - path: ".github/workflows/ci.yml"
      provides: "Backend CI with updated paths"
      contains: "working-directory: backend"
    - path: ".github/workflows/frontend-test.yml"
      provides: "Frontend CI with updated paths"
      contains: "working-directory: fe"
    - path: "CLAUDE.md"
      provides: "Root instructions with backend/ and frontend/ paths"
    - path: "backend/CLAUDE.md"
      provides: "Backend instructions with backend/ paths"
    - path: "frontend/CLAUDE.md"
      provides: "Frontend instructions with frontend/ paths"
  key_links:
    - from: ".github/workflows/ci.yml"
      to: "backend/"
      via: "working-directory and cache-dependency-path"
      pattern: "working-directory: backend"
    - from: ".github/workflows/frontend-test.yml"
      to: "frontend/"
      via: "working-directory, paths filter, and cache-dependency-path"
      pattern: "frontend/"
---

<objective>
Rename the monorepo folders (`backend/` -> `backend/`, `frontend/` -> `frontend/`) and update ALL path references across CI/CD workflows, CLAUDE.md files, documentation, and planning artifacts.

Purpose: Complete the monorepo restructure. With Go module paths already updated in Plan 01, the folder rename is now a safe `git mv` operation followed by bulk text replacement across all non-source files.

Output: Clean monorepo with `backend/` and `frontend/` directories, zero references to old folder names, all builds passing.
</objective>

<execution_context>
@/Users/jamesjordan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jamesjordan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03.3-repository-rename-folder-restructure/03.3-RESEARCH.md
@.planning/phases/03.3-repository-rename-folder-restructure/03.3-01-SUMMARY.md
@.github/workflows/ci.yml
@.github/workflows/frontend-test.yml
@CLAUDE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename Folders and Update CI/CD Workflows</name>
  <files>
    .github/workflows/ci.yml
    .github/workflows/frontend-test.yml
  </files>
  <action>
    **Step 1: Rename folders using git mv**
    ```bash
    git mv backend backend
    git mv fe fe
    ```

    **Step 2: Update CI workflow - ci.yml**
    In `.github/workflows/ci.yml`, replace ALL occurrences of `backend` with `backend`:
    - `working-directory: backend` -> `working-directory: backend` (appears twice: test job defaults, build job defaults)
    - `cache-dependency-path: backend/go.sum` -> `cache-dependency-path: backend/go.sum` (appears twice)
    - `file: backend/coverage.out` -> `file: backend/coverage.out`

    **Step 3: Update CI workflow - frontend-test.yml**
    In `.github/workflows/frontend-test.yml`, replace ALL occurrences of `frontend` with `frontend`:
    - `paths: - 'frontend/**'` -> `paths: - 'frontend/**'` (appears twice: pull_request and push)
    - `cache-dependency-path: perspective-frontend/pnpm-lock.yaml` -> `cache-dependency-path: frontend/pnpm-lock.yaml`
    - `working-directory: fe` -> `working-directory: fe` (appears twice)
    - `path: frontend/coverage/` -> `path: frontend/coverage/`

    **Step 4: Verify builds from new locations**
    ```bash
    cd backend && make test
    cd fe && pnpm run build
    ```

    **IMPORTANT: Do NOT update package.json "name" field.** Leave it as `"fe"` -- npm package name is independent of folder name (see research pitfall #5).
  </action>
  <verify>
    1. `ls backend/go.mod` succeeds (folder renamed)
    2. `ls frontend/package.json` succeeds (folder renamed)
    3. `ls backend/ 2>/dev/null` returns error (old folder gone)
    4. `ls frontend/ 2>/dev/null` returns error (old folder gone)
    5. `grep "backend" .github/workflows/ci.yml` returns zero results
    6. `grep "fe" .github/workflows/frontend-test.yml` returns zero results
    7. `cd backend && make test` passes
    8. `cd fe && pnpm run build` succeeds
  </verify>
  <done>
    - Folders renamed: backend/ and frontend/ exist, old names gone
    - CI workflows reference new folder names
    - Go tests pass from backend/ directory
    - Frontend builds from frontend/ directory
  </done>
</task>

<task type="auto">
  <name>Task 2: Bulk Update All Documentation and Planning References</name>
  <files>
    CLAUDE.md
    backend/CLAUDE.md
    frontend/CLAUDE.md
    docs/AGENTS.md
    docs/ARCHITECTURE.md
    docs/DOMAIN_GUIDE.md
    docs/GITHUB_PROJECTS.md
    docs/GO_PATTERNS.md
    docs/GSD_BRANCHING.md
    docs/LOCAL_DEVELOPMENT.md
    docs/VERIFICATION.md
    .planning/**/*.md
  </files>
  <action>
    **Step 1: Update root CLAUDE.md**
    Replace `backend` with `backend` and `frontend` with `frontend` throughout. Be careful with the `backend/CLAUDE.md` reference -- it becomes `backend/CLAUDE.md`. Same for `perspective-frontend/CLAUDE.md` -> `frontend/CLAUDE.md`.

    Also update any references to `perspectize` (the old repo name) with `perspectize` in URLs like `repos/CodeWarrior-debug/perspectize/` -> `repos/CodeWarrior-debug/perspectize/`.

    ```bash
    sed -i '' -e 's/backend/backend/g' -e 's/frontend/frontend/g' CLAUDE.md
    sed -i '' 's/perspectize/perspectize/g' CLAUDE.md
    ```

    **Step 2: Update backend CLAUDE.md**
    ```bash
    sed -i '' -e 's/backend/backend/g' backend/CLAUDE.md
    sed -i '' 's/perspectize/perspectize/g' backend/CLAUDE.md
    ```

    **Step 3: Update frontend CLAUDE.md**
    ```bash
    sed -i '' -e 's/frontend/frontend/g' frontend/CLAUDE.md
    sed -i '' -e 's/backend/backend/g' frontend/CLAUDE.md
    sed -i '' 's/perspectize/perspectize/g' frontend/CLAUDE.md
    ```

    **Step 4: Update .docs/ directory (8 markdown files)**
    ```bash
    find .docs/ -name "*.md" -type f -exec sed -i '' -e 's/backend/backend/g' -e 's/frontend/frontend/g' {} +
    find .docs/ -name "*.md" -type f -exec sed -i '' 's/perspectize/perspectize/g' {} +
    ```

    **Step 5: Update .planning/ directory**
    ```bash
    find .planning/ -name "*.md" -type f -exec sed -i '' -e 's/backend/backend/g' -e 's/frontend/frontend/g' {} +
    find .planning/ -name "*.md" -type f -exec sed -i '' 's/perspectize/perspectize/g' {} +
    ```

    **Step 6: Check .gitignore for folder-specific rules**
    ```bash
    grep "backend\|fe" .gitignore
    ```
    Update if any matches found.

    **Step 7: Check for any remaining references**
    ```bash
    grep -r "backend/" . --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=backend
    grep -r "frontend/" . --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=fe
    grep -r "perspectize" . --exclude-dir=node_modules --exclude-dir=.git
    ```
    Fix any remaining references found. Expected: zero results for backend/ and frontend/. The `perspectize` search may find references in git history descriptions within planning summaries -- those are historical records and acceptable.

    **CAUTION with sed replacements:**
    - The string `perspectize` could appear as part of folder names (like `perspectize/backend`) or as a standalone repo name. The sed will handle both correctly since `perspectize` -> `perspectize` and separately `backend` -> `backend`.
    - Order matters: run the folder name replacements FIRST (`backend` -> `backend`, `frontend` -> `frontend`), THEN the repo name replacement (`perspectize` -> `perspectize`). This prevents double-replacement issues.
    - Do NOT replace the npm package name `"fe"` in package.json -- that should stay as-is.
  </action>
  <verify>
    1. `grep -r "backend/" . --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=backend` returns zero results
    2. `grep -r "frontend/" . --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=fe` returns zero results (except package.json "name" field which is acceptable)
    3. `grep "backend" CLAUDE.md` returns zero results
    4. `grep "fe" CLAUDE.md` returns zero results
    5. `grep "backend" backend/CLAUDE.md` returns zero results
    6. `grep "working-directory: backend" .github/workflows/ci.yml` returns matches
    7. Root CLAUDE.md references `backend/CLAUDE.md` and `frontend/CLAUDE.md`
  </verify>
  <done>
    - All CLAUDE.md files reference backend/ and frontend/ (not backend/ or frontend/)
    - All 8 docs/*.md files updated
    - All .planning/*.md files updated
    - GitHub API references in CLAUDE.md use perspectize repo name
    - Zero stale path references remain in source-controlled files
    - package.json "name" field unchanged (still "fe")
  </done>
</task>

</tasks>

<verification>
- Folder structure: `ls backend/go.mod frontend/package.json` both succeed
- Old folders gone: `ls backend 2>/dev/null || ls perspective-fe 2>/dev/null` both fail
- No stale references: `grep -rn "backend\|fe" . --exclude-dir=node_modules --exclude-dir=.git --include="*.md" --include="*.yml" --include="*.yaml"` returns zero results (except package.json name)
- Backend tests: `cd backend && make test` passes
- Frontend build: `cd fe && pnpm run build` succeeds
- CI workflows: `grep "working-directory: backend" .github/workflows/ci.yml` and `grep "working-directory: fe" .github/workflows/frontend-test.yml` both match
</verification>

<success_criteria>
1. backend/ renamed to backend/ (git mv preserves history)
2. frontend/ renamed to frontend/ (git mv preserves history)
3. CI/CD workflows updated with new paths
4. All CLAUDE.md, docs, and planning files updated
5. Zero references to old folder names in source-controlled files
6. Go tests pass from backend/ directory
7. Frontend builds from frontend/ directory
</success_criteria>

<output>
After completion, create `.planning/phases/03.3-repository-rename-folder-restructure/03.3-02-SUMMARY.md`
</output>
