---
phase: 03.3-repository-rename-folder-restructure
plan: 03
type: execute
wave: 3
depends_on: ["03.3-02"]
files_modified: []
autonomous: false

user_setup:
  - service: digitalocean-app-platform
    why: "Backend deployment source directory must be updated from perspectize-go/ to backend/"
    dashboard_config:
      - task: "Update Source Directory for backend service"
        location: "DigitalOcean App Platform -> App -> Backend Service -> Settings -> Source Directory"

must_haves:
  truths:
    - "Backend deployment builds successfully from backend/ source directory"
    - "Backend API endpoint responds at its existing URL"
    - "CI/CD pipeline passes on the renamed repository"
  artifacts: []
  key_links:
    - from: "DigitalOcean App Platform"
      to: "backend/"
      via: "Source Directory configuration"
      pattern: "Source Directory: backend/"
---

<objective>
Update the DigitalOcean App Platform deployment configuration to point to the new `backend/` source directory, push all changes to GitHub, and verify CI/CD passes end-to-end.

Purpose: Without updating the deployment Source Directory, the next auto-deployment will fail with "Source directory not found". This plan completes the infrastructure cutover and verifies everything works.

Output: Working deployment from new folder structure, passing CI, confirmed backend API availability.
</objective>

<execution_context>
@/Users/jamesjordan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jamesjordan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03.3-repository-rename-folder-restructure/03.3-RESEARCH.md
@.planning/phases/03.3-repository-rename-folder-restructure/03.3-01-SUMMARY.md
@.planning/phases/03.3-repository-rename-folder-restructure/03.3-02-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 1: Update DigitalOcean App Platform Source Directory</name>
  <action>
    The backend service on DigitalOcean App Platform must have its Source Directory updated
    from `perspectize-go/` to `backend/`. This requires access to the DigitalOcean dashboard.
  </action>
  <how-to-do-it>
    1. Navigate to DigitalOcean App Platform dashboard
    2. Select the perspectize backend app
    3. Go to Settings -> Source Directory (or Components -> Backend -> Source)
    4. Change Source Directory from `perspectize-go/` to `backend/`
    5. Save the configuration
    6. If auto-deploy is enabled, this may trigger a deployment automatically
    7. If auto-deploy is disabled, you may need to trigger a manual deploy after pushing
  </how-to-do-it>
  <resume-signal>Type "updated" once the Source Directory has been changed to backend/ in DigitalOcean App Platform</resume-signal>
</task>

<task type="auto">
  <name>Task 2: Push Changes and Verify CI/CD</name>
  <files></files>
  <action>
    **Step 1: Push all committed changes to GitHub**
    Push the branch with all rename commits to GitHub. If on main, push directly. If on a feature branch, push and note the branch name.

    ```bash
    git push origin HEAD
    ```

    **Step 2: Verify CI passes**
    Check GitHub Actions for the push:
    ```bash
    gh run list --limit 3
    ```
    Wait for CI to complete. Both the backend (ci.yml) and frontend (frontend-test.yml) workflows should pass.

    If CI fails, diagnose from the logs:
    ```bash
    gh run view <run-id> --log-failed
    ```

    **Step 3: Verify backend API is accessible**
    Check that the backend API still responds at its deployed URL:
    ```bash
    curl -s -X POST https://perspectize-go-dz3qa.ondigitalocean.app/graphql \
      -H "Content-Type: application/json" \
      -d '{"query": "{ __typename }"}' | grep -q "Query" && echo "Backend API OK" || echo "Backend API FAIL"
    ```

    Note: The backend URL (`perspectize-go-dz3qa.ondigitalocean.app`) does NOT change when the source directory changes -- it's a DigitalOcean-assigned subdomain.

    **Step 4: Final stale reference check**
    Run one last sweep to confirm no old paths leaked through:
    ```bash
    grep -rn "perspectize-go/" . --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=backend --include="*.go" --include="*.yml" --include="*.yaml" --include="*.md" --include="*.json" --include="*.ts" --include="*.svelte"
    grep -rn "perspectize-fe/" . --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=fe --include="*.go" --include="*.yml" --include="*.yaml" --include="*.md" --include="*.json" --include="*.ts" --include="*.svelte"
    ```
    Expected: zero results for both (package.json "name" field is acceptable if it shows up).
  </action>
  <verify>
    1. `gh run list --limit 3` shows recent runs with passing status
    2. Backend API responds to GraphQL introspection query
    3. Zero stale path references in final sweep
  </verify>
  <done>
    - All changes pushed to GitHub
    - CI/CD passes (both backend and frontend workflows)
    - Backend API accessible at deployed URL
    - No stale references to old folder names or repo name
  </done>
</task>

</tasks>

<verification>
- CI/CD: Both GitHub Actions workflows pass
- Deployment: Backend API responds at existing URL
- Completeness: No references to perspectize-go/, perspectize-fe/, or perspectize-be in source files
</verification>

<success_criteria>
1. DigitalOcean Source Directory updated to backend/
2. All changes pushed to GitHub
3. CI/CD passes for both backend and frontend
4. Backend API responds at deployed URL
5. Phase 3.3 success criteria fully met: repo renamed, folders renamed, imports updated, deployment working
</success_criteria>

<output>
After completion, create `.planning/phases/03.3-repository-rename-folder-restructure/03.3-03-SUMMARY.md`
</output>
